webpackJsonp([4],{DPoE:function(t,a){},Iv6x:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=n("Sxqw"),e=n.n(i),s={data:function(){return{h:"",m:"",s:"",content:"",isEnd:!1}},props:{end:{type:Number,default:""},endText:{type:String,default:"已结束"},start:{type:Number,default:""}},mounted:function(){this.countdowm(this.start,this.end)},methods:{countdowm:function(t,a){var n=this,i=setInterval(function(){var t=a-(new Date).getTime();if(t>0){Math.floor(t/864e5);var e=Math.floor(t/36e5%24),s=Math.floor(t/6e4%60),r=Math.floor(t/1e3%60);n.h=e<10?"0"+e:e,n.m=s<10?"0"+s:s,n.s=r<10?"0"+r:r}else clearInterval(i),n.isEnd=!0},1e3)},_callback:function(){this.callback&&this.callback instanceof Function&&this.callback.apply(this,e()(this))}}},r={render:function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("span",{attrs:{end:t.end,endText:t.endText}},[t._t("default",[n("div",{staticClass:"counter"},[n("span",{staticClass:"timer"},[t._v(t._s(t.h||"00"))]),t._v(" "),n("span",[t._v(":")]),t._v(" "),n("span",{staticClass:"timer"},[t._v(t._s(t.m||"00"))]),t._v(" "),n("span",[t._v(":")]),t._v(" "),n("span",{staticClass:"timer"},[t._v(t._s(t.s||"00"))])])])],2)},staticRenderFns:[]};var o=n("Mz/3")(s,r,!1,function(t){n("Yb9E")},null,null).exports,c=n("go92"),l=n.n(c),u={name:"deal",data:function(){return{active:0,data:{},loading:!0,rateDialog:!1,rateValue:0,rateId:"",rateTag:""}},components:{timeCount:o},filters:{orderStatus:function(t){return{0:"等待交易开始",1:"等待付款",2:"等待确认",3:"交易成功",4:"卖家申请客服介入，请联系客服",5:"买家交易取消",6:"已冻结,因买家未及时付款，PPB已退回"}[t]},orderStatusColor:function(t){return{0:"#fad733",1:"#fad733",2:"#fad733",3:"#27c24c",4:"#f05050",5:"#999999",6:"#23b7e5"}[t]}},methods:{refresh:function(t,a){var n=this;this.$set(a,"loading",!0),this.axios.get("/public/index.php/api/Trade/shuaxin?tid="+t).then(function(t){1===t.state&&(n.$toast(t.msg),n.getData())})},onClickLeft:function(){this.$router.push({name:"userInfo"})},getData:function(){var t=this;this.axios.get("/public/index.php/api/user/trade1").then(function(a){t.loading=!1,1===a.state&&(t.data=a)})},cancelOrder:function(t){var a=this;this.$dialog.confirm({title:"",message:"确定取消?"}).then(function(){a.axios.get("/public/index.php/api/trade/cancel?tid="+t).then(function(t){1===t.state&&(a.$toast("交易已取消"),a.getData())})}).catch(function(){})},cancelSale:function(t){var a=this;this.$dialog.confirm({title:"",message:"确定取消?"}).then(function(){a.axios.get("/public/index.php/api/trade/weituo_quxiao?tid="+t).then(function(t){1===t.state&&(a.$toast("交易已取消"),a.getData())})}).catch(function(){})},pay:function(t){this.$router.push({name:"pay",query:{id:t}})},see:function(t){this.$router.push({name:"see",query:{id:t}})},pendingOrder:function(t,a){var n=this;this.$dialog.confirm({title:"标题",message:1===a?"交易开始后将冻结您的PPB，是否开始":"是否取消"}).then(function(i){n.axios.post("/public/index.php/api/Trade/zhiding_queren",{bianhao:t,zhuangtai:a}).then(function(t){1===t.state&&(n.$toast(t.msg),n.getData())})}).catch(function(){})},datePlus:function(t,a){return t=t.replace(/-/g,"/"),Date.parse(new Date(new Date(t).valueOf()+60*a*60*1e3))},showSaleRate:function(t,a){this.rateDialog=!0,this.rateId=t,this.rateTag=a},submitRate:function(t,a){var n=this;if("cancel"===t)return a(),!1;this.rateTag?this.axios.post("/public/index.php/api/trade/m_j_pingjia1/id/"+this.rateId,{assess:this.rateValue}).then(function(t){1===t.state&&(n.$toast(t.msg),n.rateValue=0,n.getData(),a())}):this.axios.post("/public/index.php/api/trade/mj_pingjia/id/"+this.rateId,{assess:this.rateValue}).then(function(t){1===t.state&&(n.$toast(t.msg),n.rateValue=0,n.getData(),a())})},copy:function(){var t=this,a=new l.a(".tag-read");a.on("success",function(n){t.$toast("复制成功"),a.destroy()}),a.on("error",function(t){console.log("该浏览器不支持自动复制"),a.destroy()})}},mounted:function(){this.active=this.$route.query.active||0,this.getData()}},d={render:function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"deal"},[n("van-nav-bar",{attrs:{title:"交易","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),t.loading?n("p",{staticClass:"flex-center"},[n("van-loading")],1):t._e(),t._v(" "),t.loading?t._e():n("van-tabs",{model:{value:t.active,callback:function(a){t.active=a},expression:"active"}},[n("van-tab",{attrs:{title:"买入订单"}},t._l(t.data.data_mairu,function(a,i){return n("div",{key:i,staticClass:"in-item",staticStyle:{"padding-bottom":"50px"}},[n("div",[t._v("编号："+t._s(a.zhendeid)+"\n          "),n("van-button",{staticClass:"m-t-xs m-b-xs m-r pull-right",attrs:{type:"primary",size:"small",loading:a.loading},on:{click:function(n){t.refresh(a.zhendeid,a)}}},[t._v("刷新\n          ")])],1),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi))]),t._v(" "),n("div",[t._v("时间："+t._s(a.shijian))]),t._v(" "),n("div",[n("van-button",{staticClass:"m-t-xs m-b-xs m-r pull-right",attrs:{type:"danger",size:"small"},on:{click:function(n){t.cancelOrder(a.zhendeid)}}},[t._v("取消\n          ")])],1),t._v(" "),n("van-row",{attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"5",offset:"19"}})],1)],1)})),t._v(" "),n("van-tab",{attrs:{title:"卖出订单"}},t._l(t.data.weituochushou,function(a,i){return n("div",{key:i,staticClass:"in-item",staticStyle:{"padding-bottom":"50px"}},[n("div",[t._v("编号："+t._s(a.Id+2e4)+"\n         ")]),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi_dj))]),t._v(" "),n("div",[t._v("时间："+t._s(a.shijian))]),t._v(" "),n("div",[n("van-button",{staticClass:"m-t-xs m-b-xs m-r pull-right",attrs:{type:"danger",size:"small"},on:{click:function(n){t.cancelSale(a.Id+2e4)}}},[t._v("取消\n          ")])],1),t._v(" "),n("van-row",{attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"5",offset:"19"}})],1)],1)})),t._v(" "),n("van-tab",{attrs:{title:"交易中"}},[t.data.data_maijia?[t._l(t.data.data_maijia,function(a,i){return n("div",{key:i+"_",staticClass:"in-item"},[n("div",[t._v("编号："+t._s(a.bianhao))]),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi))]),t._v(" "),n("div",{staticClass:"tag-read",attrs:{"data-clipboard-text":a.maijia},on:{click:t.copy}},[t._v("买家："+t._s(a.maijia)+" "),n("span",{staticClass:"text-muted text-sm m-l-xs"},[t._v("(点击复制)")])]),t._v(" "),n("div",{staticClass:"tag-read",attrs:{"data-clipboard-text":a.mai_jia},on:{click:t.copy}},[t._v("卖家："+t._s(a.mai_jia)+" "),n("span",{staticClass:"text-muted text-sm m-l-xs"},[t._v("(点击复制)")])]),t._v(" "),n("div",[a.chuangjianshijian?n("span",[t._v("时间："+t._s(a.chuangjianshijian))]):t._e(),t._v(" "),1==a.dingdanzhuangtai?n("span",{staticClass:"pull-right m-r"},[n("time-count",{attrs:{start:Date.parse(a.chuangjianshijian),end:t.datePlus(a.chuangjianshijian,2)}})],1):t._e()]),t._v(" "),n("van-row",{staticClass:"m-t",attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"18"}},[t._v("状态：\n              "),n("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t._f("orderStatus")(a.dingdanzhuangtai))+"\n              ")])],1),t._v(" "),n("van-col",{attrs:{span:"5"}},[1==a.dingdanzhuangtai?n("van-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){t.pay(a.bianhao)}}},[t._v("支付\n              ")]):t._e()],1)],1)],1)}),t._v(" "),t._l(t.data.data_mai_jia,function(a,i){return n("div",{key:i,staticClass:"in-item"},[n("div",[t._v("编号："+t._s(a.bianhao))]),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi))]),t._v(" "),n("div",{staticClass:"tag-read",attrs:{"data-clipboard-text":a.maijia},on:{click:t.copy}},[t._v("买家："+t._s(a.maijia)+" "),n("span",{staticClass:"text-muted text-sm"},[t._v("(点击复制)")])]),t._v(" "),n("div",{staticClass:"tag-read",attrs:{"data-clipboard-text":a.mai_jia},on:{click:t.copy}},[t._v("卖家："+t._s(a.mai_jia)+" "),n("span",{staticClass:"text-muted text-sm"},[t._v("(点击复制)")])]),t._v(" "),n("div",[a.chuangjianshijian?n("span",[t._v("时间："+t._s(a.chuangjianshijian))]):t._e(),t._v(" "),2==a.dingdanzhuangtai?n("span",{staticClass:"pull-right m-r",on:{click:function(n){t.see(a.bianhao)}}},[n("time-count",{attrs:{start:Date.parse(a.chuangjianshijian),end:t.datePlus(a.fukuanshijian,1)}})],1):t._e()]),t._v(" "),n("van-row",{staticClass:"m-t",attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"14"}},[t._v("状态：\n              "),n("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t._f("orderStatus")(a.dingdanzhuangtai)))])],1),t._v(" "),n("van-col",{attrs:{span:"10"}},[2==a.dingdanzhuangtai?n("van-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){t.see(a.bianhao)}}},[t._v("查看\n              ")]):t._e(),t._v(" "),0==a.dingdanzhuangtai?n("van-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){t.pendingOrder(a.bianhao,1)}}},[t._v("交易确认\n              ")]):t._e(),t._v(" "),0==a.dingdanzhuangtai?n("van-button",{attrs:{size:"small"},on:{click:function(n){t.pendingOrder(a.bianhao,2)}}},[t._v("交易取消\n              ")]):t._e()],1)],1)],1)})]:t._e()],2),t._v(" "),n("van-tab",{attrs:{title:"出售完成"}},t._l(t.data.data_mai_jia_ok,function(a,i){return n("div",{staticClass:"in-item"},[n("div",[t._v("编号："+t._s(a.bianhao))]),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi))]),t._v(" "),n("div",[t._v("时间："+t._s(a.chuangjianshijian))]),t._v(" "),n("van-row",{attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"18"}},[t._v("状态：\n            "),n("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t._f("orderStatus")(a.dingdanzhuangtai))+"\n            ")])],1),t._v(" "),n("van-col",[3==a.dingdanzhuangtai&&1!=a.m_jpingfen?n("van-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){t.showSaleRate(a.bianhao,1)}}},[t._v("评价\n            ")]):t._e(),t._v(" "),3==a.dingdanzhuangtai&&1==a.m_jpingfen?n("span",[n("van-icon",{attrs:{name:"like",color:"red"}}),n("span",{staticClass:"text-muted pull-left"},[t._v("(已评价)")])],1):t._e()],1)],1)],1)})),t._v(" "),n("van-tab",{attrs:{title:"购买完成"}},t._l(t.data.data_maijia_ok,function(a,i){return n("div",{staticClass:"in-item"},[n("div",[t._v("编号："+t._s(a.bianhao))]),t._v(" "),n("div",[t._v("数量："+t._s(a.shuliang))]),t._v(" "),n("div",[t._v("人民币："+t._s(a.renmingbi))]),t._v(" "),n("div",[t._v("\n          时间："+t._s(a.chuangjianshijian)+"\n        ")]),t._v(" "),n("van-row",{attrs:{type:"flex",justify:"space-between"}},[n("van-col",{attrs:{span:"18"}},[t._v("状态：\n            "),n("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t._f("orderStatus")(a.dingdanzhuangtai))+"\n            ")])],1),t._v(" "),n("van-col",[3==a.dingdanzhuangtai&&1!=a.mjpingfen?n("van-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){t.showSaleRate(a.bianhao,0)}}},[t._v("评价\n            ")]):t._e(),t._v(" "),3==a.dingdanzhuangtai&&1==a.mjpingfen?n("span",[n("van-icon",{attrs:{name:"like",color:"red"}}),n("span",{staticClass:"text-muted pull-left"},[t._v("(已评价)")])],1):t._e()],1)],1)],1)})),t._v(" "),n("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.submitRate},model:{value:t.rateDialog,callback:function(a){t.rateDialog=a},expression:"rateDialog"}},[n("div",{staticClass:"padder padder-v "},[t._v("\n        评分:\n        "),n("div",{staticClass:"text-center"},[n("van-rate",{staticClass:"m-t",model:{value:t.rateValue,callback:function(a){t.rateValue=a},expression:"rateValue"}})],1)])])],1)],1)},staticRenderFns:[]};var v=n("Mz/3")(u,d,!1,function(t){n("DPoE")},null,null);a.default=v.exports},R63W:function(t,a,n){n("OubH"),n("VExX"),t.exports=n("hkgF").Array.from},Sxqw:function(t,a,n){"use strict";a.__esModule=!0;var i,e=n("fHpZ"),s=(i=e)&&i.__esModule?i:{default:i};a.default=function(t){if(Array.isArray(t)){for(var a=0,n=Array(t.length);a<t.length;a++)n[a]=t[a];return n}return(0,s.default)(t)}},VExX:function(t,a,n){"use strict";var i=n("SrjJ"),e=n("dwHk"),s=n("3UZo"),r=n("F4Le"),o=n("L6YH"),c=n("NOEY"),l=n("sFeG"),u=n("M0zt");e(e.S+e.F*!n("MhzF")(function(t){Array.from(t)}),"Array",{from:function(t){var a,n,e,d,v=s(t),_="function"==typeof this?this:Array,h=arguments.length,p=h>1?arguments[1]:void 0,f=void 0!==p,g=0,m=u(v);if(f&&(p=i(p,h>2?arguments[2]:void 0,2)),void 0==m||_==Array&&o(m))for(n=new _(a=c(v.length));a>g;g++)l(n,g,f?p(v[g],g):v[g]);else for(d=m.call(v),n=new _;!(e=d.next()).done;g++)l(n,g,f?r(d,p,[e.value,g],!0):e.value);return n.length=g,n}})},Yb9E:function(t,a){},fHpZ:function(t,a,n){t.exports={default:n("R63W"),__esModule:!0}},sFeG:function(t,a,n){"use strict";var i=n("will"),e=n("4Sro");t.exports=function(t,a,n){a in t?i.f(t,a,e(0,n)):t[a]=n}}});