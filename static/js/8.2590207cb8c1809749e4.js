webpackJsonp([8],{"1ykS":function(t,s){},"DU/P":function(t,s){},Ri2X:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"counter"},[a("button",{staticClass:"btn-left",on:{click:t.j}},[t._v("-")]),t._v(" "),a("input",{ref:"input",staticClass:"count-input",attrs:{type:"tel"},domProps:{value:t.value},on:{input:t.input}}),t._v(" "),a("button",{staticClass:"btn-right",on:{click:t.plus}},[t._v("+")])])},staticRenderFns:[]};var n={name:"lottery",components:{counter:a("Mz/3")({name:"counter",data:function(){return{value:10}},props:["min","max"],methods:{input:function(t){var s=t.target.value.replace(/[^\d]/g,"");this.value=s,this.$refs.input.value=s,this.$emit("change",this.value)},plus:function(){this.value<this.max&&(this.value+=10,this.$emit("change",this.value))},j:function(){this.value>10&&(this.value-=10,this.$emit("change",this.value))}}},i,!1,function(t){a("DU/P")},"data-v-1fbf21d8",null).exports},data:function(){return{popupShow:!1,loading:!0,value:10,need:0,show:!1,historyShow:!1,data:{},id:-1,dijilun:-1,historyList:[]}},computed:{},methods:{onClickLeft:function(){this.$router.back()},beforeClose:function(t,s){var a=this;if("confirm"===t){if(this.value%10)return this.$toast("最小10魔力,且为10的整数倍"),s(),!1;this.axios.post("/public/index.php/api/pj/mairu",{Id:this.id,dijilun:this.dijilun,shuliang:this.value}).then(function(t){a.value=10,s(),1===t.state&&(a.$toast(t.msg),a.getData(),a.getHistory())})}else s()},getHistory:function(){var t=this;this.axios.get("/public/index.php/api/pj/qu_jilu").then(function(s){1===s.state&&(t.historyList=s.data)})},counterChange:function(t){this.value=t},getData:function(){var t=this;this.axios.get("/public/index.php/api/pj/pingjiang").then(function(s){t.loading=!1,1===s.state&&(t.data=s)})},pj:function(t,s,a){this.show=!0,this.need=s,this.id=t,this.dijilun=a}},filters:{statusStr:function(t){return{"-1":"未开奖",0:"未中奖",1:"中奖"}[t]},statusClass:function(t){return{"-1":"text-warning",0:"text-primary",1:"text-danger"}[t]}},mounted:function(){this.getData(),this.getHistory()}},e={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{attrs:{id:"lottery"}},[i("div",{staticClass:"wrapper"},[i("div",{staticClass:"header"},[i("van-nav-bar",{attrs:{title:"公益拼奖","left-arrow":""},on:{"click-left":t.onClickLeft}},[i("van-icon",{attrs:{slot:"right",name:"question"},on:{click:function(s){t.popupShow=!0}},slot:"right"})],1)],1),t._v(" "),t.loading?i("p",{staticClass:"flex-center"},[i("van-loading")],1):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[i("div",{staticClass:"wrapper bg-white user"},[i("van-row",[i("van-col",{attrs:{span:8,offset:1}},[i("img",{staticClass:"thumb-lg",attrs:{src:t.data.touxiang_data,alt:""}})]),t._v(" "),i("van-col",{staticClass:"text-left",attrs:{span:13,offset:2}},[i("p",{staticClass:"ml"},[t._v("魔力："),i("span",{staticClass:"m-l-sm"},[t._v(t._s(t.data.moni_data))])]),t._v(" "),i("div",[i("span",{staticClass:"history",on:{click:function(s){t.historyShow=!0}}},[t._v("拼奖记录")]),t._v(" "),i("span",{staticClass:"share",on:{click:function(s){t.$router.push({name:"share"})}}},[t._v("助力赢PPB")])])])],1)],1),t._v(" "),i("div",{staticClass:"list"},[i("van-row",{attrs:{type:"flex",justify:"space-between"}},t._l(t.data.data,function(s,n){return i("van-col",{key:n,attrs:{span:11}},[i("div",{staticClass:"lottery-item"},[i("img",{attrs:{src:a("rd8q"),alt:""}}),t._v(" "),i("div",{staticClass:"detail bg-white"},[i("div",{staticClass:"text-md"},[t._v(t._s(s.shangpingmingzi))]),t._v(" "),i("div",[t._v("\n                  价值：￥"+t._s(s.jiazhi)+"\n                  "),i("span",{staticClass:"pull-right"},[t._v("[第"+t._s(s.dijilun)+"期]")])]),t._v(" "),i("div",{staticClass:"progress m-t pos-rlt"},[i("div",{staticClass:"progress-bar progress-bar-info progress-bar-striped active",style:"width:"+s.suoxu/s.xuyao*100+"%;"}),t._v(" "),i("span",{staticClass:"progress-value"},[t._v(t._s((s.suoxu/s.xuyao*100).toFixed(2))+"%")])]),t._v(" "),i("div",{staticClass:"text-center m-t-md"},[i("van-button",{attrs:{size:"small"},on:{click:function(a){t.pj(s.Id,s.suoxu,s.dijilun)}}},[t._v("\n                    我要拼奖\n                  ")])],1)])])])}))],1)])]),t._v(" "),i("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.beforeClose},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[i("div",{staticClass:"wrapper-lg"},[i("p",{staticClass:"text-center"},[t._v("还可买入:"+t._s(t.need)+"魔力")]),t._v(" "),i("counter",{attrs:{min:10,max:t.need},on:{change:t.counterChange}}),t._v(" "),i("p",{staticClass:"text-muted text-sm text-center"},[t._v("最小10魔力,且为10的整数倍")])],1)]),t._v(" "),i("van-dialog",{model:{value:t.historyShow,callback:function(s){t.historyShow=s},expression:"historyShow"}},[i("div",{staticClass:"wrapper"},[i("p",{staticClass:"text-center"},[t._v("拼奖记录")]),t._v(" "),i("div",{staticClass:" wrapper"},[t.historyList.length<1?i("p",{staticClass:"text-center"},[t._v("你还没有参加过拼奖活动哟")]):t._e(),t._v(" "),t._l(t.historyList,function(s,a){return i("div",{staticClass:"text-sm b-b m-b"},[i("van-tag",{attrs:{type:"primary"}},[t._v(t._s(s.mingzi))]),t._v(" "),i("span",{staticClass:"pull-right"},[i("span",{class:t._f("statusClass")(s.zhuangtai)},[t._v(t._s(t._f("statusStr")(s.zhuangtai)))])]),t._v(" "),i("div",{staticClass:"m-t-sm"},[t._v("\n            买入数量 : "+t._s(s.shuliang)+"\n            "),i("span",{staticClass:"pull-right"},[t._v(t._s(s.shijian))])])],1)})],2)])]),t._v(" "),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.popupShow,callback:function(s){t.popupShow=s},expression:"popupShow"}},[i("div",{staticClass:"wrapper"},[i("div",[i("p",{staticClass:"text-center"},[t._v("\n          拼奖规则\n        ")]),t._v(" "),i("div",[t._v("\n          1、每件商品参考市场价平分成相应“等份”，每份10魔力，1份对应1个抽奖码。"),i("br"),t._v("\n          2、同一件商品可以一次购买多份"),i("br"),t._v("\n          3、当一件商品所有“等份”拼购完成时，开始计算中奖会员，每一期只有一个中奖会员"),i("br"),t._v("\n          4、每一期完成后自动开始下一期拼奖开始"),i("br")]),t._v(" "),i("p",{staticClass:"text-center"},[t._v("助力规则")]),t._v(" "),i("div",[t._v("\n          1、获取二维码邀请好友来扫一扫，每次助力可获得10~88点魔力哦"),i("br"),t._v("\n          2、每个用户每日限为10个好友助力"),i("br"),t._v("\n          3、魔力可参加公益拼奖"),i("br")])])])])],1)},staticRenderFns:[]};var o=a("Mz/3")(n,e,!1,function(t){a("V+1d"),a("1ykS")},null,null);s.default=o.exports},"V+1d":function(t,s){},rd8q:function(t,s,a){t.exports=a.p+"static/img/lottery_bg.4efd21f.png"}});