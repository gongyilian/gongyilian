webpackJsonp([9],{HrwD:function(t,e,a){t.exports=a("niaF")},hfV4:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("HrwD"),n=a.n(i),r={name:"modifyPwd",data:function(){return{form:{idnumber:"",realname:""},imgLoading:!1,imgLoading1:!1,imgSrc:"",imgSrc1:"",imgTag:-1,imgState:!1,imgState1:!1,loading:!0}},methods:{getData:function(){var t=this;this.axios.get("/public/index.php/api/user/shiming").then(function(e){t.loading=!1,1===e.state&&e.error&&t.$dialog.alert({title:"提示",message:e.msg}).then(function(e){t.$router.push({name:"userInfo"})})})},onClickLeft:function(){this.$router.push({name:"userInfo"})},selectFile:function(t){return this.form.realname?this.form.idnumber?(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(this.form.idnumber),this.$refs.file_input.click(),void(this.imgTag=t)):(this.$toast("请先输入身份证号码"),!1):(this.$toast("请输入姓名"),!1)},submit:function(){},upImg:function(t){var e=this,a=t.target.files[0];(new FileReader).readAsDataURL(a),n.a.photoCompress(a,{quality:.8},function(t){var a=new FormData;a.append("idnumber",e.form.idnumber),a.append("fileVal",t),a.append("realname",e.form.realname),e.imgTag?e.upIdCard(a,t):e.face(a,t)})},upIdCard:function(t,e){var a=this;this.imgLoading=!0,this.axios.post("/public/index.php/api/user/facesfz",t).then(function(t){a.imgLoading=!1,1===t.state&&(a.imgState=!0,a.imgSrc=e,setTimeout(function(){a.$dialog.alert({title:"提示",message:t.msg}).then(function(){})},500))})},face:function(t,e){var a=this;this.imgLoading1=!0,this.axios.post("/public/index.php/api/user/face",t).then(function(t){a.imgLoading1=!1,1===t.state&&(a.imgState1=!0,a.imgSrc1=e,setTimeout(function(){a.$dialog.alert({title:"提示",message:t.msg}).then(function(){a.$router.push({name:"userInfo"})})},500))})}},mounted:function(){this.getData()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modifyPwd"},[a("van-nav-bar",{attrs:{title:"实名认证","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),t.loading?a("p",{staticClass:"flex-center"},[a("van-loading")],1):t._e(),t._v(" "),t.loading?t._e():a("div",[a("van-cell-group",[a("van-field",{attrs:{required:"",clearable:"",label:"姓名",placeholder:"请输入姓名"},model:{value:t.form.realname,callback:function(e){t.$set(t.form,"realname",e)},expression:"form.realname"}}),t._v(" "),a("van-field",{attrs:{label:"身份证号",placeholder:"请输入身份证号",required:""},model:{value:t.form.idnumber,callback:function(e){t.$set(t.form,"idnumber",e)},expression:"form.idnumber"}})],1),t._v(" "),a("div",{staticClass:"m-t bg-white padder padder-v"},[a("van-row",{attrs:{type:"flex",justify:"space-between"}},[a("van-col",{attrs:{span:"11"}},[a("p",{staticClass:"text-center"},[t._v("请上传身份证图片")]),t._v(" "),a("div",{staticClass:"text-center"},[a("div",{staticClass:"imgBox",on:{click:function(e){t.selectFile(1)}}},[t.imgSrc?a("img",{attrs:{src:t.imgSrc,alt:""}}):t._e(),t._v(" "),t.imgSrc||t.imgLoading?t._e():a("van-icon",{attrs:{name:"photograph",size:"2em"}}),t._v(" "),t.imgLoading?a("van-loading"):t._e()],1),t._v(" "),a("van-tag",{attrs:{type:t.imgState?"success":"danger"}},[t._v(t._s(t.imgState?"已识别":"未识别"))])],1)]),t._v(" "),a("van-col",{attrs:{span:"11"}},[a("p",{staticClass:"text-center"},[t._v("请上传人脸识别图片")]),t._v(" "),a("div",{staticClass:"text-center"},[a("div",{staticClass:"imgBox",on:{click:function(e){t.selectFile(0)}}},[t.imgSrc1?a("img",{attrs:{src:t.imgSrc1,alt:""}}):t._e(),t._v(" "),t.imgSrc1||t.imgLoading1?t._e():a("van-icon",{attrs:{name:"photograph",size:"2em"}}),t._v(" "),t.imgLoading1?a("van-loading"):t._e()],1),t._v(" "),a("van-tag",{attrs:{type:t.imgState1?"success":"danger"}},[t._v(t._s(t.imgState1?"已识别":"未识别"))])],1)])],1)],1),t._v(" "),a("input",{ref:"file_input",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.upImg}}),t._v(" "),a("div",{staticClass:"padder-md"},[a("van-button",{staticClass:"m-t",attrs:{size:"large",type:"primary"},on:{click:t.submit}},[t._v("认证")])],1)],1)],1)},staticRenderFns:[]};var o=a("Mz/3")(r,s,!1,function(t){a("mpU5")},null,null);e.default=o.exports},mpU5:function(t,e){},niaF:function(t,e){t.exports={photoCompress:function(t,e,a){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){!function(t,e,a){var i=new Image;i.src=t,i.onload=function(){var t=this.width,i=this.height,n=t/i;t=e.width||t,i=e.height||t/n;var r=.7,s=document.createElement("canvas"),o=s.getContext("2d"),c=document.createAttribute("width");c.nodeValue=t;var l=document.createAttribute("height");l.nodeValue=i,s.setAttributeNode(c),s.setAttributeNode(l),o.drawImage(this,0,0,t,i),e.quality&&e.quality<=1&&e.quality>0&&(r=e.quality);var m=s.toDataURL("image/jpeg",r);a(m)}}(this.result,e,a)}},convertBase64UrlToBlob:function(t){for(var e=t.split(","),a=e[0].match(/:(.*?);/)[1],i=atob(e[1]),n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);return new Blob([r],{type:a})}}}});